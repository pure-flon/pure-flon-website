<!DOCTYPE html>
<!-- 
íŒŒì¼ëª…: customer/login.html
ì—…ë°ì´íŠ¸: 2025-01-22
ë²„ì „: v2.0.0 (ì™„ì „í•œ B2B ê³ ê° í¬í„¸ ì‹œìŠ¤í…œ)
-->
<html lang="ko" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pure-Flon ê³ ê° í¬í„¸ ë¡œê·¸ì¸ - ê²¬ì  ë‚´ì—­, ì£¼ë¬¸ ê´€ë¦¬, ê¸°ìˆ  ë¬¸ì„œ ë‹¤ìš´ë¡œë“œ ë“± ì „ìš© ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”.">
    <meta name="keywords" content="Pure-Flon ë¡œê·¸ì¸, ê³ ê° í¬í„¸, B2B ë¡œê·¸ì¸, ê²¬ì  ê´€ë¦¬">
    <meta name="robots" content="noindex, nofollow">
    
    <title>ê³ ê° í¬í„¸ ë¡œê·¸ì¸ | Pure-Flon</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="../css/main.css" as="style">
    <link rel="preload" href="../css/customer-portal.css" as="style">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/customer-portal.css">
</head>
<body class="login-page">
    <!-- Skip to main content -->
    <a href="#main-content" class="skip-link">ë©”ì¸ ì½˜í…ì¸ ë¡œ ê±´ë„ˆë›°ê¸°</a>
    
    <!-- Header (Simplified for login) -->
    <header class="header header--minimal" role="banner">
        <div class="header__container">
            <div class="header__logo">
                <a href="../" aria-label="Pure-Flon í™ˆí˜ì´ì§€">
                    <img src="../images/logo.svg" alt="Pure-Flon" width="180" height="40">
                </a>
            </div>
            
            <div class="header__actions">
                <a href="../" class="btn btn--outline btn--sm">í™ˆìœ¼ë¡œ</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" role="main" class="login-main">
        <div class="login-container">
            <!-- Login Form Section -->
            <div class="login-form-section">
                <div class="login-header">
                    <h1>ê³ ê° í¬í„¸ ë¡œê·¸ì¸</h1>
                    <p>Pure-Flon ì „ìš© ê³ ê° ì„œë¹„ìŠ¤ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤</p>
                </div>

                <!-- Login Form -->
                <form id="login-form" class="login-form" novalidate>
                    <div class="form-group">
                        <label for="email">ì´ë©”ì¼ ì£¼ì†Œ</label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            required 
                            autocomplete="email"
                            placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
                            aria-describedby="email-error"
                        >
                        <div id="email-error" class="error-message" role="alert"></div>
                    </div>

                    <div class="form-group">
                        <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                        <div class="password-input">
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                required 
                                autocomplete="current-password"
                                placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                                aria-describedby="password-error"
                            >
                            <button type="button" class="password-toggle" aria-label="ë¹„ë°€ë²ˆí˜¸ ë³´ê¸°/ìˆ¨ê¸°ê¸°">
                                ğŸ‘ï¸
                            </button>
                        </div>
                        <div id="password-error" class="error-message" role="alert"></div>
                    </div>

                    <div class="form-group form-group--checkbox">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remember-me" name="rememberMe">
                            <span class="checkmark"></span>
                            ë¡œê·¸ì¸ ì •ë³´ ê¸°ì–µí•˜ê¸°
                        </label>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary btn--full" id="login-button">
                            <span class="btn-text">ë¡œê·¸ì¸</span>
                            <span class="btn-spinner" style="display: none;">
                                <span class="spinner"></span>
                            </span>
                        </button>
                    </div>

                    <div class="form-links">
                        <a href="#" class="forgot-password-link" onclick="showForgotPasswordModal()">
                            ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?
                        </a>
                    </div>
                </form>

                <!-- Social Login (Optional) -->
                <div class="social-login">
                    <div class="social-divider">
                        <span>ë˜ëŠ”</span>
                    </div>
                    
                    <div class="social-buttons">
                        <button class="social-btn social-btn--google" onclick="signInWithGoogle()">
                            <svg class="social-icon" width="20" height="20" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                            Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
                        </button>
                    </div>
                </div>

                <!-- Registration Link -->
                <div class="registration-prompt">
                    <p>ì•„ì§ ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?</p>
                    <a href="register.html" class="btn btn--outline">ê³„ì • ë§Œë“¤ê¸°</a>
                </div>
            </div>

            <!-- Benefits Section -->
            <div class="login-benefits-section">
                <div class="benefits-content">
                    <h2>ê³ ê° í¬í„¸ ì„œë¹„ìŠ¤</h2>
                    <p>Pure-Flon ê³ ê° í¬í„¸ì—ì„œ ë‹¤ìŒ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                    
                    <div class="benefits-list">
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ“Š</div>
                            <div class="benefit-content">
                                <h3>ê²¬ì  ë° ì£¼ë¬¸ ê´€ë¦¬</h3>
                                <p>ì‹¤ì‹œê°„ìœ¼ë¡œ ê²¬ì  ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì£¼ë¬¸ ë‚´ì—­ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ“š</div>
                            <div class="benefit-content">
                                <h3>ê¸°ìˆ  ë¬¸ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬</h3>
                                <p>ì œí’ˆ ë°ì´í„°ì‹œíŠ¸, ì¸ì¦ì„œ, ì„¤ì¹˜ ê°€ì´ë“œë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ¯</div>
                            <div class="benefit-content">
                                <h3>ë§ì¶¤í˜• ê°€ê²© ì •ë³´</h3>
                                <p>ê³ ê° ë“±ê¸‰ì— ë”°ë¥¸ íŠ¹ë³„ í• ì¸ê°€ì™€ ëŒ€ëŸ‰ ì£¼ë¬¸ í˜œíƒì„ í™•ì¸í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ› ï¸</div>
                            <div class="benefit-content">
                                <h3>ì „ë‹´ ê¸°ìˆ  ì§€ì›</h3>
                                <p>ì „ë¬¸ ì—”ì§€ë‹ˆì–´ì™€ ì§ì ‘ ì†Œí†µí•˜ë©° ê¸°ìˆ ì  ë¬¸ì œë¥¼ í•´ê²°í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸš€</div>
                            <div class="benefit-content">
                                <h3>ìš°ì„  ë‚©ê¸° ì„œë¹„ìŠ¤</h3>
                                <p>ë“±ê¸‰ë³„ ìš°ì„  ìƒì‚° ë° ë°°ì†¡ ì„œë¹„ìŠ¤ë¡œ ë¹ ë¥¸ ë‚©ê¸°ë¥¼ ë³´ì¥ë°›ìœ¼ì„¸ìš”</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ“ˆ</div>
                            <div class="benefit-content">
                                <h3>êµ¬ë§¤ ë¶„ì„ ë¦¬í¬íŠ¸</h3>
                                <p>ì›”ë³„ êµ¬ë§¤ ë‚´ì—­ê³¼ ë¹„ìš© ë¶„ì„ì„ í†µí•´ ë” ë‚˜ì€ êµ¬ë§¤ ê²°ì •ì„ í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Forgot Password Modal -->
    <div id="forgot-password-modal" class="modal" style="display: none;">
        <div class="modal-backdrop">
            <div class="modal-container">
                <div class="modal-header">
                    <h3>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</h3>
                    <button class="modal-close" onclick="closeForgotPasswordModal()">&times;</button>
                </div>
                
                <div class="modal-body">
                    <p>ë“±ë¡í•˜ì‹  ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì‹œë©´ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ë¥¼ ë°œì†¡í•´ë“œë¦½ë‹ˆë‹¤.</p>
                    
                    <form id="forgot-password-form">
                        <div class="form-group">
                            <label for="reset-email">ì´ë©”ì¼ ì£¼ì†Œ</label>
                            <input 
                                type="email" 
                                id="reset-email" 
                                name="resetEmail" 
                                required 
                                placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
                            >
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn--outline" onclick="closeForgotPasswordModal()">
                                ì·¨ì†Œ
                            </button>
                            <button type="submit" class="btn btn--primary" id="reset-button">
                                ì¬ì„¤ì • ë§í¬ ì „ì†¡
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="success-message" class="notification notification--success" style="display: none;">
        <span class="notification-text"></span>
        <button class="notification-close">&times;</button>
    </div>

    <!-- Error Message -->
    <div id="error-message" class="notification notification--error" style="display: none;">
        <span class="notification-text"></span>
        <button class="notification-close">&times;</button>
    </div>

    <!-- Scripts -->
    <script src="../js/main.js"></script>
    <script src="../js/modules/CustomerPortal.js"></script>
    <script>
        // ê³ ê° í¬í„¸ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ
        class LoginSystem {
            constructor() {
                this.supabase = window.supabase?.createClient(
                    window.SUPABASE_URL,
                    window.SUPABASE_ANON_KEY
                );
                this.form = document.getElementById('login-form');
                this.passwordToggle = document.querySelector('.password-toggle');
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.checkExistingSession();
                console.log('ğŸ” ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
            }

            setupEventListeners() {
                // ë¡œê·¸ì¸ í¼ ì œì¶œ
                this.form.addEventListener('submit', (e) => this.handleLogin(e));

                // ë¹„ë°€ë²ˆí˜¸ í† ê¸€
                this.passwordToggle.addEventListener('click', () => this.togglePassword());

                // Enter í‚¤ ì²˜ë¦¬
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && document.activeElement.form === this.form) {
                        e.preventDefault();
                        this.handleLogin(e);
                    }
                });

                // ì•Œë¦¼ ë‹«ê¸° ë²„íŠ¼
                document.querySelectorAll('.notification-close').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.target.closest('.notification').style.display = 'none';
                    });
                });

                // ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í¼
                document.getElementById('forgot-password-form').addEventListener('submit', (e) => {
                    this.handlePasswordReset(e);
                });
            }

            async checkExistingSession() {
                if (!this.supabase) return;

                try {
                    const { data: { session } } = await this.supabase.auth.getSession();
                    if (session) {
                        // ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœë©´ ëŒ€ì‹œë³´ë“œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                        this.redirectToDashboard();
                    }
                } catch (error) {
                    console.error('ì„¸ì…˜ í™•ì¸ ì‹¤íŒ¨:', error);
                }
            }

            async handleLogin(e) {
                e.preventDefault();
                
                const submitButton = document.getElementById('login-button');
                const btnText = submitButton.querySelector('.btn-text');
                const btnSpinner = submitButton.querySelector('.btn-spinner');
                
                // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
                this.setLoadingState(true);
                
                try {
                    // í¼ ë°ì´í„° ìˆ˜ì§‘
                    const formData = new FormData(this.form);
                    const email = formData.get('email').trim();
                    const password = formData.get('password');
                    const rememberMe = formData.get('rememberMe') === 'on';

                    // ê¸°ë³¸ ìœ íš¨ì„± ê²€ì‚¬
                    if (!this.validateForm(email, password)) {
                        this.setLoadingState(false);
                        return;
                    }

                    if (this.supabase) {
                        // Supabase ë¡œê·¸ì¸
                        const { data, error } = await this.supabase.auth.signInWithPassword({
                            email,
                            password
                        });

                        if (error) {
                            throw error;
                        }

                        // ë¡œê·¸ì¸ ì„±ê³µ
                        this.showNotification('ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                        
                        // ë¡œê·¸ì¸ ì •ë³´ ê¸°ì–µí•˜ê¸° ì²˜ë¦¬
                        if (rememberMe) {
                            localStorage.setItem('rememberEmail', email);
                        } else {
                            localStorage.removeItem('rememberEmail');
                        }

                        // ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
                        setTimeout(() => {
                            this.redirectToDashboard();
                        }, 1000);

                    } else {
                        // Supabase ì—†ì´ë„ ì‘ë™í•˜ë„ë¡ ì‹œë®¬ë ˆì´ì…˜
                        await this.simulateLogin(email, password);
                    }

                } catch (error) {
                    console.error('ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
                    this.handleLoginError(error);
                } finally {
                    this.setLoadingState(false);
                }
            }

            async simulateLogin(email, password) {
                // ê°œë°œ/í…ŒìŠ¤íŠ¸ìš© ì‹œë®¬ë ˆì´ì…˜ ë¡œê·¸ì¸
                await new Promise(resolve => setTimeout(resolve, 1500)); // ë¡œë”© ì‹œë®¬ë ˆì´ì…˜

                // í…ŒìŠ¤íŠ¸ ê³„ì •ë“¤
                const testAccounts = [
                    { email: 'test@pure-flon.com', password: 'test123' },
                    { email: 'demo@pure-flon.com', password: 'demo123' },
                    { email: 'admin@pure-flon.com', password: 'admin123' }
                ];

                const validAccount = testAccounts.find(
                    account => account.email === email && account.password === password
                );

                if (validAccount) {
                    // ì„ì‹œ ì„¸ì…˜ ì €ì¥
                    sessionStorage.setItem('customer_session', JSON.stringify({
                        email: email,
                        loginTime: new Date().toISOString(),
                        sessionId: Math.random().toString(36).substr(2, 9)
                    }));

                    this.showNotification('ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    setTimeout(() => this.redirectToDashboard(), 1000);
                } else {
                    throw new Error('ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
            }

            validateForm(email, password) {
                let isValid = true;
                
                // ì´ë©”ì¼ ê²€ì¦
                if (!email) {
                    this.showFieldError('email', 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                    isValid = false;
                } else if (!this.isValidEmail(email)) {
                    this.showFieldError('email', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤');
                    isValid = false;
                } else {
                    this.clearFieldError('email');
                }

                // ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
                if (!password) {
                    this.showFieldError('password', 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                    isValid = false;
                } else if (password.length < 6) {
                    this.showFieldError('password', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤');
                    isValid = false;
                } else {
                    this.clearFieldError('password');
                }

                return isValid;
            }

            showFieldError(fieldName, message) {
                const field = document.getElementById(fieldName);
                const errorDiv = document.getElementById(`${fieldName}-error`);
                
                field.classList.add('error');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }

            clearFieldError(fieldName) {
                const field = document.getElementById(fieldName);
                const errorDiv = document.getElementById(`${fieldName}-error`);
                
                field.classList.remove('error');
                errorDiv.textContent = '';
                errorDiv.style.display = 'none';
            }

            handleLoginError(error) {
                let message = 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                
                if (error.message.includes('Invalid login credentials')) {
                    message = 'ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                } else if (error.message.includes('Email not confirmed')) {
                    message = 'ì´ë©”ì¼ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ì¸ì¦ ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                } else if (error.message.includes('Too many requests')) {
                    message = 'ë„ˆë¬´ ë§ì€ ë¡œê·¸ì¸ ì‹œë„ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                } else if (error.message.includes('User not found')) {
                    message = 'ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë©”ì¼ì…ë‹ˆë‹¤.';
                } else {
                    message = error.message;
                }

                this.showNotification(message, 'error');
            }

            setLoadingState(loading) {
                const submitButton = document.getElementById('login-button');
                const btnText = submitButton.querySelector('.btn-text');
                const btnSpinner = submitButton.querySelector('.btn-spinner');
                
                if (loading) {
                    submitButton.disabled = true;
                    btnText.style.display = 'none';
                    btnSpinner.style.display = 'inline-block';
                    submitButton.classList.add('loading');
                } else {
                    submitButton.disabled = false;
                    btnText.style.display = 'inline';
                    btnSpinner.style.display = 'none';
                    submitButton.classList.remove('loading');
                }
            }

            togglePassword() {
                const passwordInput = document.getElementById('password');
                const isPassword = passwordInput.type === 'password';
                
                passwordInput.type = isPassword ? 'text' : 'password';
                this.passwordToggle.textContent = isPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸';
            }

            isValidEmail(email) {
                return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            }

            showNotification(message, type) {
                const notification = document.getElementById(`${type === 'success' ? 'success' : 'error'}-message`);
                const textElement = notification.querySelector('.notification-text');
                
                textElement.textContent = message;
                notification.style.display = 'block';
                
                // ìë™ìœ¼ë¡œ 3ì´ˆ í›„ ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }

            redirectToDashboard() {
                // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL í™•ì¸
                const urlParams = new URLSearchParams(window.location.search);
                const returnUrl = urlParams.get('returnUrl');
                
                if (returnUrl && returnUrl.startsWith('/')) {
                    window.location.href = returnUrl;
                } else {
                    window.location.href = 'portal/dashboard.html';
                }
            }

            // ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
            async handlePasswordReset(e) {
                e.preventDefault();
                
                const resetButton = document.getElementById('reset-button');
                const resetEmail = document.getElementById('reset-email').value.trim();
                
                if (!this.isValidEmail(resetEmail)) {
                    alert('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                try {
                    resetButton.disabled = true;
                    resetButton.textContent = 'ì „ì†¡ ì¤‘...';

                    if (this.supabase) {
                        const { error } = await this.supabase.auth.resetPasswordForEmail(resetEmail, {
                            redirectTo: `${window.location.origin}/customer/reset-password.html`
                        });

                        if (error) throw error;
                    } else {
                        // ì‹œë®¬ë ˆì´ì…˜
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }

                    this.showNotification('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ê°€ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    this.closeForgotPasswordModal();

                } catch (error) {
                    console.error('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì‹¤íŒ¨:', error);
                    alert('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                } finally {
                    resetButton.disabled = false;
                    resetButton.textContent = 'ì¬ì„¤ì • ë§í¬ ì „ì†¡';
                }
            }
        }

        // ì „ì—­ í•¨ìˆ˜ë“¤
        function showForgotPasswordModal() {
            document.getElementById('forgot-password-modal').style.display = 'block';
            document.getElementById('reset-email').focus();
        }

        function closeForgotPasswordModal() {
            document.getElementById('forgot-password-modal').style.display = 'none';
            document.getElementById('forgot-password-form').reset();
        }

        async function signInWithGoogle() {
            alert('Google ë¡œê·¸ì¸ ê¸°ëŠ¥ì´ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤!');
            // TODO: Google OAuth êµ¬í˜„
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            window.PureFlonLogin = new LoginSystem();
            
            // ì €ì¥ëœ ì´ë©”ì¼ ë³µì›
            const rememberEmail = localStorage.getItem('rememberEmail');
            if (rememberEmail) {
                document.getElementById('email').value = rememberEmail;
                document.getElementById('remember-me').checked = true;
            }
        });

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        window.addEventListener('click', function(e) {
            const modal = document.getElementById('forgot-password-modal');
            if (e.target === modal) {
                closeForgotPasswordModal();
            }
        });
    </script>
</body>
</html>